<?xml version="1.0" encoding="UTF-8" ?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/templates/general.xhtml">

	<ui:define name="title">
		<h:outputText value="Nowy temat" />
	</ui:define>
	<ui:define name="header">
		<h:outputText value="Nowy temat" />
	</ui:define>

	<ui:define  name="content">
	
		<script src="http://maps.google.com/maps/api/js?sensor=true"
			type="text/javascript"></script>
			
		<div id="top">
			<div id="MENU">mwnue
			
			<h:form>
			<h:commandLink value="Strona główna" action="goToMainPage"/> <br />
			
			<h:commandLink value="Moje konto" action="goToHome"/> <br />
			
			<h:commandLink value="Dodaj temat" action="editUserTopic"/> <br />
			
			<h:commandLink value="Znajomi"/> <br />
			</h:form>
			
			
			</div>

			<div id="TRESC">
		<p:growl id="growl" showDetail="true" />
		
		<h:form id="userTopicAddForm">
			<p:fieldset styleClass="fieldset" legend="Nowy temat">
				<p:focus />
				<p:messages id="messages" globalOnly="true" />


				<h:panelGrid id="dataPanelGrid" columns="2"
					style="margin: 0 auto; margin-top: 25px; text-align: left"
					cellspacing="3" cellpadding="3">


					<h:outputText for="topicCat" value="Categories:" />
					<p:selectOneMenu id="topicCat" value="#{newTopic.category}">

						<f:selectItems
							itemLabel="#{topicCategoryService.getAllTopicCategory()}"
							value="#{topicCategoryService.getAllTopicCategory()}" />
					</p:selectOneMenu>

					<h:outputText for="topicTitle" value="Tytul:" />
					<h:inputText id="topicTitle" value="#{newTopic.name}" />

					<h:outputText for="topicArea" value="Opis:" />
					<h:inputTextarea id="topicArea" value="#{newTopic.describe}" />

					<p:outputLabel for="city" value="Misto:" />
					<p:selectOneMenu id="city" value="#{adressTopic.city}"
						style="width:125px">
						<f:selectItem itemLabel="Select City" itemValue="" />
						<f:selectItem itemLabel="Kielce" itemValue="Kielce" />
						<f:selectItem itemLabel="Kraków" itemValue="Kraków" />
						<f:selectItem itemLabel="Łódź" itemValue="Łódz" />
					</p:selectOneMenu>
					
					<p:outputLabel for="street" value="Ulica:" />
					<h:inputText id="street" value="#{adressTopic.street}" />
					
					<p:outputLabel for="post" value="Kod pocztowy:" />
					<h:inputText id="post" value="#{adressTopic.postCode}" />
					
					<p:outputLabel for="number" value="Numer:" />
					<h:inputText id="number" value="#{adressTopic.numberPos}" />
					
					
					
					<p:outputLabel value="Dodaj znacznik:" />
					<p:commandButton id="btn" type="button" icon="ui-icon-pin-s"
						value="Pokaz mape" onclick="PF('dlg0').show();" />
				</h:panelGrid>
			</p:fieldset>
			<p:commandButton id="backToAccount" action="backToAccount"
				immediate="true" icon="ui-icon-arrowreturnthick-1-w"
				value="Back to Account" />
			<p:commandButton id="confirmNewUserTopic"
				action="confirmNewUserTopic" icon="ui-icon-check" value="Sava topic" />
		</h:form>
<!-- 		<p:commandButton id="btn" type="button" icon="ui-icon-pin-s" -->
<!-- 			value="Show Map" onclick="dlg0.show();" /> -->



		<p:dialog id="gmapDialog" widgetVar="dlg0" width="625" height="400"
			modal="true">
			<!-- 			<p:gmap id="gmap" center="41.381542, 2.122893" zoom="15" -->
			<!-- 				type="HYBRID" style="width:100%;height:400px" /> -->
			<p:gmap id="gmap" center="36.890257,30.707417" zoom="13"
				type="HYBRID" style="width:100%;height:400px"
				model="#{topicService.mapModel}"
				onPointClick="handlePointClick(event);" widgetVar="map">
				<p:ajax event="markerDrag" listener="#{topicService.onMarkerDrag}"
					update="growl" />
			</p:gmap>
		</p:dialog>







		<p:dialog widgetVar="dlg" showEffect="fade">
			<h:form prependId="false">

				<h:panelGrid columns="2">
					<h:outputLabel for="title" value="Title:" />
						<p:inputText id="title" value="#{topicService.title}" />
						<h:inputHidden id="title1" value="#{newTopic.title}" />
					<f:facet name="footer">
						<p:commandButton value="Add"
							actionListener="#{topicService.addMarker}" update=":growl,:gmap"
							oncomplete="markerAddComplete()" />
						<p:commandButton value="Cancel" onclick="return cancel()" />
					</f:facet>
				</h:panelGrid>

				<h:inputHidden id="lat" value="#{topicService.lat}" />
				<h:inputHidden id="lat1" value="#{newTopic.lat}" />
				<h:inputHidden id="lng" value="#{topicService.lng}" />
				<h:inputHidden id="lng1" value="#{newTopic.lng}" />
				
			</h:form>
		</p:dialog>

		<script type="text/javascript">
			var currentMarker = null;

			function handlePointClick(event) {
				if (currentMarker === null) {
					document.getElementById('lat').value = event.latLng.lat();
					document.getElementById('lng').value = event.latLng.lng();

					currentMarker = new google.maps.Marker({
						position : new google.maps.LatLng(event.latLng.lat(),
								event.latLng.lng())
					});

					PF('map').addOverlay(currentMarker);

					PF('dlg').show();
				}
			}

			function markerAddComplete() {
				var title = document.getElementById('title');
				currentMarker.setTitle(title.value);
				title.value = "";

				currentMarker = null;
				PF('dlg').hide();
			}

			function cancel() {
				PF('dlg').hide();
				currentMarker.setMap(null);
				currentMarker = null;

				return false;
			}

			function geocode() {
		        PF('geoMap').geocode(document.getElementById('address').value);
		    }
		</script>
	</div>
	
	

  
	
	
	<div id="STOPKA">ss</div>
	</div>
	</ui:define>

</ui:composition>
